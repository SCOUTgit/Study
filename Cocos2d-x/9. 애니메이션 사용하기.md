# 애니메이션 사용하기
## 애니메이션
- 애니메이션은 프레임을 차례대로 정해진 시간차를 둬서 출력함으로 생성할 수 있다.
- 각 프레임별 이미지를 출력할 때는 캐릭터 밖의 배경에 해당하는 색은 그리지 않는다.
---
## 애니메이션 기초
```C++
// 애니메이션 생성
CCAnimation* 애니메이션_이름 = CCAnimation::create();
// 애니메이션의 각 프레임별 시간 간격 설정
애니메이션_이름->setDelayPerUnit(시간);
// 애니메이션의 프레임(스프라이트) 추가
애니메이션->addSpriteFrameWithFileName("스프라이트 경로");
// 애니메이션 액션 생성
CCAnimate* 애니메이션_액션_이름 = CCAnimate::create(애니메이션_이름);
// 기존 스프라이트에 애니메이션 액션 실행
스프라이트_이름->runAction(애니메이션_액션_이름);
```
---
## 애니메이션 스프라이트배치노드 응용
- Cocos2d-x에서 스프라이트는 이밎 파일을 읽어들여 OpenGL상에서 사용할 수 있는 CCTexture2D 형식으로 변환한다.
- 여러 개의 리소스가 있다면 파일을 읽고 OpenGL 렌더링 루틴을 호출해 변환하고 OpenGL캐시로 보관하는 과정을 반복한다.
- 읽어들이는 리소스가 많아질수록 시스템 비용이 많이 발생한다.
- 리소스를 읽어들이는 횟수를 줄이기 위해 스프라이트배치노드를 응용해서 애니메이션을 만든다.
### 스프라이트배치노드
- 전달된 스프라이트 시트 이미지를 참조해서 인스턴스를 만들고 애니메이션 액션이 실행될 때 각 프레임 정보를 참조해 OpenGL 배치 드로잉 루틴을 호출한다.
- 스프라이트배치노드는 드로잉 가능한 객체가 차일드로 존재할 때만 해당 차일드를 그린다.
```C++
// 스프라이트 배치 노드 생성
CCSpriteBatchNode* 배치노드_이름 = CCSpriteBatchNode::create("아틀라스 이미지 경로");
// 애니메이션 생성
CCAnimation* 애니메이션_이름 = CCAnimation::create();
// 애니메이션의 각 프레임별 시간 간격 설정
애니메이션_이름->setDelayPerUnit(시간);
// 애니메이션에 각 프레임 추가
for(int i=0; i<프레임의_갯수; i++){
    int index = i % 각_줄의_프레임의_갯수;
    in rowIndex = i / 줄의_갯수;
    // CCRectMake함수는 Cocos2d-x 의 좌표와 달리 (0, 0)이 좌측상단이다.
    애니메이션_이름->addSpriteFrameWithTexture(배치노드_이름->getTexture(), 
    CCRectMake(index*프레임의_가로, rowIndex*프레임의_세로, 프레임의_가로,프레임의_세로));
}
// 애니메이션을 실행할 스프라이트 생성
CCSprite* 스프라이트_이름 = CCSprite::create(배치노드_이름->getTexture(),
    CCRectMake(0, 0, 프레임의_가로,프레임의_세로));
// 배치노드에 스프라이트 자식으로 추가
배치노드_이름->addChild(스프라이트_이름);
```